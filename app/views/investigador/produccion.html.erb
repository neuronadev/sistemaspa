<style>
.contprod{
   display: flex;
   flex-direction: column;
   width: 80%;
   margin-bottom: 15px;
   padding: 2px 4px 6px 7px;
   margin-left: 10px;
   border: 1px solid grey;
   background-color: white;
}

.rwp{
   display: flex;
   flex-direction: row;
   
}
.rwopts{
   display: flex;
   flex-direction: row;
   margin-top:15px;
}
.divide{
   height:15px; 
}

.hoptions{
   margin-left: 10px;
   width: 100%;
   margin-bottom: 15px; 
}
.frmopt{
   display: flex;
   flex-direction: row;
}

.detallep{
   display: flex;
   flex-direction: column;
   margin-top: 15px;
}
.itemdetallep{
    display: flex;
    flex-direction: row;
}


</style>

<div class="hoptions">
  <strong> <%= link_to "Regresar", investlista_path %> </strong>
</div>

<div class="hoptions">
  <strong>  <%=  (@persona.paterno||'') + ' ' + (@persona.materno||'') + ' ' + (@persona.nombre||'') %></strong> 
</div>

<%  
    @actividad.each do |a|
    @producto = Producto.find(a.producto_id)
    @dataAct = Actividad.find(a.id)
%>



  <div class="contprod">
        <div class="rwp">
             <div style="font-weight: bold; color:#154360; text-decoration: underline grey;"><%= a.producto.descripcion %></div>
             <div style="margin-left:20px; color:blue;"><b>Año:</b> <%= a.anio %></div>
             <div style="margin-left:20px; color:blue;"><b>Folio:</b> <%= a.id %></div>
        </div>
        <div class="divide"></div>
        <div><b>Título:</b> <%= a.titulo %> </div>
        <div><b>Autores:</b> <%= cita(a.id).html_safe %> </div>
        <div class="rwp"> <div style="font-weight: bold;">Comprobante:</div>  
        <% if a.documentos.attached? %> 
            <div style="font-size:14px; margin-left:10px;">  
                <% a.documentos.each do |d|%>
                    <%= link_to rails_blob_path(d, disposition: "inline"),  target: '_blank' do %>
                        <i class="fas fa-file-pdf"></i> Ver documento
                    <% end %>
                <% end %>
            </div>
        <% end %> 
        </div>  

        <div class="detallep">
            <%= render partial: "detalle/tipo"  %>
        </div>


        <% if a.estado == 'C' %> 
                <div class="rwopts">
                    <div id="val<%= a.id %>" style="font-size:14px; color:green;"> 
                            <%= link_to validasa_path(a.id), remote:true, data:{confirm:'El registro se marcará como validado, ¿desea continuar?'} do %>    
                                <i class="fas fa-check-double text-success"></i> Validar
                            <% end %>
                    </div>
                    <div id="no<%= a.id %>" style="margin-left:10px; font-size:14px; color:red; cursor: pointer; " onclick="showform(<%= a.id %>)"> 
                            <i class="fas fa-times text-danger"></i></i> No considerar
                    </div> 
                    <div id="rechazar<%= a.id %>" class="formrechaza" style="margin-left:10px; font-size:14px; color:red;">
                        <div>Motivo:</div> 
                        <div> <textarea id="motivotxt<%= a.id %>" name="textarea" rows="5" cols="70"></textarea> </div>
                        <div class="frmopt">
                                 <div style="cursor: pointer;" onclick="aceptarform(<%= a.id %>)">Aceptar</div>
                                 <div onclick="cancelform(<%= a.id %>)" style="cursor: pointer;">Cancelar</div> 
                        </div>
                    </div>

                </div>
            <% else %> 
                <% if a.estado == 'S' %> 
                    <div style="margin-top:15px; color:green; font-weight: bold;">Producto aceptado</div>
                <% end %> 
                
                <% if a.estado == 'Z' %>  
                    <div style="margin-top:15px; color:red;">Producto rechazado</div>
                    <div id="txtrechazav<%= a.id %>"></div> 
                <% end %>
            <% end %>

  </div>

<% end %>

<br><br>

<script>
    $(function () {
        $('.formrechaza').hide(); 
    });
     
    function showform(idact){
        $('#rechazar'+idact).show();  
    }

    function hideform(idact){
        $('#rechazar'+idact).hide();  
    }
    function cancelform(idact){
        $('#rechazar'+idact).hide();  
    }
    function aceptarform(idact){
          $.ajax({
                    url: '<%= rechazasa_path %>',
                    data: "id="+idact + "&txt=" + $("#motivotxt"+idact).val(),
                    type: "get",
                    success: function(data){ 
                         alert("Registro marcado.");
                     },
                    error: function(dayta){   }
                })
    }

</script>